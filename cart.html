<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>Your Cart</title>
    <link rel="icon" type="image/png" href="icon/32.png" />
    <style>
      body {
        margin: 0;
        padding: 60px 0 100px 0;
        font-family: Helvetica, Arial, sans-serif;
        background: #f4f4f4;
        color: #333;
      }

      /* Â§¥ÈÉ® */
      .site-header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 55px;
        background: #000;
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 15px;
        z-index: 100;
      }
      .header-btn {
        font-weight: bold;
        cursor: pointer;
        font-size: 0.9rem;
      }

      /* Âç°ÁâáÂàóË°® */
      .cart-list {
        list-style: none;
        padding: 15px;
        margin: 0;
        display: grid;
        gap: 15px;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      }
      .cart-item {
        background: #fff;
        padding: 15px;
        border-radius: 8px;
        display: flex;
        gap: 15px;
        position: relative;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      }
      .item-img {
        width: 80px;
        height: 80px;
        object-fit: contain;
        background: #f9f9f9;
        border-radius: 4px;
      }
      .item-details {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }
      .item-title {
        font-size: 0.95rem;
        line-height: 1.3;
        margin-bottom: 5px;
        padding-right: 20px;
      }
      .item-price {
        color: #b28900;
        font-weight: bold;
      }

      /* Âà†Èô§ÊåâÈíÆ (Â¢ûÂ§ßÁÉ≠Âå∫) */
      .remove-btn {
        position: absolute;
        top: 5px;
        right: 5px;
        width: 40px;
        height: 40px;
        font-size: 1.5rem;
        color: #ccc;
        border: none;
        background: none;
        line-height: 1;
        cursor: pointer;
      }

      /* Êï∞ÈáèÊéßÂà∂ (Â¢ûÂ§ßÂ∞∫ÂØ∏) */
      .qty-wrapper {
        display: flex;
        align-items: center;
        border: 1px solid #ddd;
        border-radius: 4px;
        width: 120px;
        height: 44px;
        margin-top: 8px;
      }
      .qty-btn {
        flex: 1;
        height: 100%;
        border: none;
        background: #fff;
        font-size: 1.2rem;
        font-weight: bold;
        cursor: pointer;
      }
      .qty-btn:active {
        background: #eee;
      }
      .qty-val {
        width: 40px;
        text-align: center;
        font-weight: bold;
      }

      /* Â∫ïÈÉ®ÁªìÁÆó */
      .cart-footer {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background: #fff;
        padding: 15px;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
        z-index: 100;
      }
      .total-row {
        display: flex;
        justify-content: space-between;
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 15px;
      }
      .checkout-btn {
        width: 100%;
        background: #25d366;
        color: #fff;
        border: none;
        padding: 15px;
        font-size: 1.1rem;
        font-weight: bold;
        border-radius: 6px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
      }

      .empty-state {
        text-align: center;
        padding: 50px 20px;
      }
      .btn-continue {
        display: inline-block;
        background: #000;
        color: #fff;
        padding: 12px 30px;
        border-radius: 30px;
        text-decoration: none;
        margin-top: 20px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <header class="site-header">
      <div class="header-btn" onclick="goBack()">&#8592; Back</div>
      <div>SHOPPING CART</div>
      <div class="header-btn" onclick="clearCart()">Clear</div>
    </header>

    <ul id="cart-list" class="cart-list"></ul>

    <div id="cart-footer" class="cart-footer" style="display: none">
      <div class="total-row">
        <span>Total:</span>
        <span id="total-price">$0.00</span>
      </div>
      <button class="checkout-btn" onclick="sendOrder()">
        <span>Send Order via WhatsApp</span>
      </button>
    </div>

    <script>
      // ËøîÂõûÈ¶ñÈ°µ (‰ΩøÁî® history.back() ÈÖçÂêà index.html ÁöÑ sessionStorage ÊÅ¢Â§ç‰ΩçÁΩÆ)
      function goBack() {
        // Â¶ÇÊûúÊúâÂéÜÂè≤ËÆ∞ÂΩïÂàôËøîÂõûÔºåÂê¶ÂàôË∑≥ËΩ¨
        if (document.referrer.includes("index.html")) {
          history.back();
        } else {
          window.location.href = "index.html";
        }
      }

      let cart = [];
      const container = document.getElementById("cart-list");
      const footer = document.getElementById("cart-footer");
      const totalEl = document.getElementById("total-price");

      function init() {
        cart = JSON.parse(localStorage.getItem("perfumeCart") || "[]");
        render();
      }

      function render() {
        container.innerHTML = "";
        if (cart.length === 0) {
          container.innerHTML = `
                    <div class="empty-state">
                        <p style="color:#999;">Your cart is empty.</p>
                        <a href="javascript:void(0)" onclick="goBack()" class="btn-continue">Continue Shopping</a>
                    </div>`;
          footer.style.display = "none";
          return;
        }

        footer.style.display = "block";
        let total = 0;

        cart.forEach((item, idx) => {
          total += item.price * item.quantity;
          const li = document.createElement("li");
          li.className = "cart-item";
          li.innerHTML = `
                    <button class="remove-btn" onclick="removeItem(${idx})">&times;</button>
                    <img src="${item.img}" class="item-img" loading="lazy">
                    <div class="item-details">
                        <div class="item-title">${item.caption}</div>
                        <div class="item-price">$${(
                          item.price * item.quantity
                        ).toFixed(2)}</div>
                        <div class="qty-wrapper">
                            <button class="qty-btn" onclick="updateQty(${idx}, -1)">-</button>
                            <div class="qty-val">${item.quantity}</div>
                            <button class="qty-btn" onclick="updateQty(${idx}, 1)">+</button>
                        </div>
                    </div>
                `;
          container.appendChild(li);
        });

        // ÁÆÄÂçïÊäòÊâ£ÈÄªËæëÁ§∫‰æã (ÂèØÊ†πÊçÆÈúÄÊ±ÇÊÅ¢Â§çÂ§çÊùÇÈÄªËæë)
        // ËøôÈáå‰∏∫‰∫Ü‰ª£Á†ÅÁÆÄÊ¥ÅÂ±ïÁ§∫Âü∫Á°Ä Total
        totalEl.textContent = "$" + total.toFixed(2);
      }

      window.updateQty = (idx, delta) => {
        cart[idx].quantity += delta;
        if (cart[idx].quantity <= 0) cart.splice(idx, 1);
        localStorage.setItem("perfumeCart", JSON.stringify(cart));
        render();
      };

      window.removeItem = (idx) => {
        if (confirm("Remove item?")) {
          cart.splice(idx, 1);
          localStorage.setItem("perfumeCart", JSON.stringify(cart));
          render();
        }
      };

      window.clearCart = () => {
        if (confirm("Clear cart?")) {
          localStorage.removeItem("perfumeCart");
          cart = [];
          render();
        }
      };

      window.sendOrder = () => {
        if (!cart.length) return;
        let msg = "*New Order* üì¶%0A%0A";
        cart.forEach((i) => {
          msg += `${i.caption} x ${i.quantity}%0A`;
        });
        msg += `%0A*Total: ${totalEl.textContent}*`;
        window.open(`https://wa.me/16232027321?text=${msg}`, "_blank");
      };

      init();
    </script>
  </body>
</html>
