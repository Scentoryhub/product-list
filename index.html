<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <title>Top Outlet Perfume</title>
    <link rel="icon" type="image/png" href="icon/32.png" />
    <link rel="apple-touch-icon" href="icon/180.png" />

    <style>
      /* ================= 1. ÂÖ®Â±ÄÈÖçÁΩÆ ================= */
      :root {
        --header-height: 60px;
        --sidebar-width: 300px;
        --accent-color: #b28900;
        --bg-color: #f8f8f8;
        --font-main: "Helvetica Neue", Helvetica, Arial, sans-serif;

        /* Ê†áÁ≠æÈ¢úËâ≤ÈÖçÁΩÆ */
        --tag-hot: #d9534f;
        --tag-new: #007bff;
        --tag-sale: #28a745;
      }

      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        margin: 0;
        padding: 0;
        padding-top: var(--header-height);
        padding-bottom: 60px;
        font-family: var(--font-main);
        background: var(--bg-color);
        color: #333;
        -webkit-font-smoothing: antialiased;
        overflow-x: hidden;
      }

      a {
        text-decoration: none;
        color: inherit;
        cursor: pointer;
      }
      button {
        outline: none;
        font-family: inherit;
        border: none;
        background: none;
        padding: 0;
      }

      /* ================= 2. Â§¥ÈÉ® (Header) ================= */
      .site-header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: var(--header-height);
        background-color: #000;
        color: #fff;
        display: flex;
        align-items: center;
        padding: 0 10px;
        z-index: 1000;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        gap: 10px;
      }
      .header-left {
        display: flex;
        align-items: center;
        gap: 5px;
        cursor: pointer;
        flex-shrink: 0;
      }
      .hamburger-icon {
        font-size: 1.6rem;
        line-height: 1;
      }
      .menu-text {
        font-size: 0.8rem;
        font-weight: 700;
        letter-spacing: 1px;
        display: none;
      }
      @media (min-width: 360px) {
        .menu-text {
          display: inline;
        }
      }

      .header-center {
        flex-grow: 1;
        display: flex;
        justify-content: flex-end;
      }
      .header-search-input {
        width: 100%;
        background: #333;
        border: 1px solid #444;
        color: #fff;
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 0.9rem;
        outline: none;
        transition: all 0.2s;
      }
      .header-search-input:focus {
        background: #fff;
        color: #000;
        border-color: #fff;
      }

      .header-right {
        position: relative;
        cursor: pointer;
        display: flex;
        align-items: center;
        flex-shrink: 0;
        padding-right: 5px;
      }
      .header-cart-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: #d9534f;
        color: white;
        font-size: 0.7rem;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        border: 2px solid #000;
      }

      /* ================= 3. ‰æßËæπÊ†è (Sidebar) ================= */
      .sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1001;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
      }
      .sidebar-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        width: 85%;
        max-width: var(--sidebar-width);
        background: #fff;
        z-index: 1002;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        display: flex;
        flex-direction: column;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      }
      .sidebar.active {
        transform: translateX(0);
      }

      .sidebar-header {
        display: flex;
        border-bottom: 2px solid #ddd;
      }
      .sidebar-tab {
        flex: 1;
        text-align: center;
        padding: 15px 0;
        font-weight: 700;
        font-size: 0.9rem;
        color: #888;
        background: #f9f9f9;
      }
      .sidebar-tab.active {
        background: #fff;
        color: #000;
        border-bottom: 2px solid var(--accent-color);
        margin-bottom: -2px;
      }
      .sidebar-content {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        -webkit-overflow-scrolling: touch;
      }
      .menu-link {
        display: block;
        padding: 15px 0;
        font-size: 1rem;
        font-weight: 600;
        color: #333;
        border-bottom: 1px solid #eee;
        text-transform: uppercase;
      }
      .brand-list {
        display: flex;
        flex-direction: column;
        gap: 0;
      }
      .brand-item {
        padding: 12px 5px;
        font-size: 0.95rem;
        color: #555;
        cursor: pointer;
        border-bottom: 1px solid #f0f0f0;
      }
      .brand-item:hover {
        color: #000;
        background: #f4f4f4;
        padding-left: 10px;
        font-weight: bold;
      }

      /* ================= 4. ÊûÅÁÆÄÁâàË¥≠Áâ©ÊåáÂºï (Compact Guide) ================= */
      .compact-guide {
        background: #fff;
        padding: 15px 10px;
        border-bottom: 8px solid #f8f8f8; /* ÊµÖÁÅ∞Ëâ≤ÂàÜÈöîÊù° */
        margin-bottom: 10px;
      }

      .compact-steps {
        display: flex;
        justify-content: space-between; /* ‰∏§Á´ØÂØπÈΩê */
        align-items: flex-start;
        max-width: 450px; /* ÈôêÂà∂ÊúÄÂ§ßÂÆΩÂ∫¶ */
        margin: 0 auto;
      }

      .compact-item {
        flex: 1;
        text-align: center;
        position: relative;
        padding: 0 2px;
      }

      /* Ê≠•È™§‰πãÈó¥ÁöÑÁÅ∞Ëâ≤Â∞èÁÆ≠Â§¥ ‚Ä∫ */
      .compact-item:not(:last-child)::after {
        content: "‚Ä∫";
        position: absolute;
        right: -6px;
        top: 8px;
        font-size: 1.6rem;
        color: #e0e0e0;
        line-height: 0;
        font-weight: 300;
      }

      .compact-icon {
        font-size: 1.5rem;
        margin-bottom: 6px;
        display: block;
        line-height: 1;
      }

      .compact-text {
        font-size: 0.75rem; /* 12px */
        line-height: 1.2;
        color: #333;
        font-weight: 700;
        margin-bottom: 2px;
      }

      .compact-sub {
        font-size: 0.65rem; /* 10px - ‰Ωú‰∏∫Ë°•ÂÖÖËØ¥Êòé */
        color: #999;
        display: block;
        font-weight: 500;
        transform: scale(0.95);
      }

      /* ================= ÊâπÂèëÊ®™ÂπÖ (Wholesale Banner) - Âõ∫ÂÆöÁâà ================= */
      .ws-banner {
        background: #222;
        color: #fff;
        padding: 10px 5px;
        text-align: center;
        transition: background 0.3s;

        /* Ê†∏ÂøÉ‰øÆÊîπÔºöÂõ∫ÂÆöÂú®È°∂ÈÉ® */
        position: sticky;
        top: var(--header-height); /* Á¥ßË¥¥ Header ‰∏ãÊñπ */
        z-index: 990; /* Á°Æ‰øùÂú®‰∫ßÂìÅÂàóË°®‰πã‰∏äÔºå‰ΩÜÂú®ÂºπÁ™ó‰πã‰∏ã */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15); /* Âä†Èò¥ÂΩ±ÔºåÂ¢ûÂä†Â±ÇÊ¨°ÊÑü */
      }

      /* ÂΩìÊúâÊäòÊâ£Â§Ñ‰∫éÊøÄÊ¥ªÁä∂ÊÄÅÊó∂ÔºåËÉåÊôØÂèòÈáëËâ≤ */
      .ws-banner.active-tier {
        background: linear-gradient(135deg, #111 0%, #2a2a2a 100%);
        border-bottom: 3px solid #ffd700;
      }

      /* ËøõÂ∫¶Êù°ÂÆπÂô® */
      .ws-progress-box {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        padding: 6px 10px;
        margin: 0 auto;
        max-width: 95%;
        display: inline-block;
      }
      .ws-progress-text {
        font-size: 0.85rem;
        margin-bottom: 2px;
        color: #fff;
      }
      .ws-highlight {
        color: #ffd700;
        font-weight: bold;
        font-size: 1rem;
      }

      /* ÈªòËÆ§ÊòæÁ§∫ÁöÑ Pill */
      .ws-pills {
        display: flex;
        justify-content: center;
        gap: 6px;
        flex-wrap: wrap;
      }
      .ws-pill {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid #444;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
      }
      .ws-pill span {
        color: #ffd700;
        font-weight: bold;
        margin-left: 3px;
      }

      /* ================= 5. È™®Êû∂Â±è‰∏éÂõæÁâáÂä†ËΩΩÂä®Áîª ================= */
      @keyframes skeleton-loading {
        0% {
          background-position: 200% 0;
        }
        100% {
          background-position: -200% 0;
        }
      }

      .skeleton-loader {
        background: #f0f0f0;
        background-image: linear-gradient(
          90deg,
          #f0f0f0 25%,
          #e0e0e0 50%,
          #f0f0f0 75%
        );
        background-size: 200% 100%;
        animation: skeleton-loading 1.5s infinite;
      }

      img.lazy-img {
        opacity: 0;
        transition: opacity 0.4s ease-in;
      }
      img.lazy-img.loaded {
        opacity: 1;
      }

      /* ================= 6. È¶ñÈ°µ (Home View) ================= */
      #home-view {
        padding-bottom: 30px;
        display: block;
      }

      .brand-section {
        margin-bottom: 20px;
        background: #fff;
        padding: 20px 0;
        border-top: 1px solid #eee;
        border-bottom: 1px solid #eee;
        scroll-margin-top: 130px; /* Ë∞ÉÊï¥ÔºöÈò≤Ê≠¢Ë¢´Âõ∫ÂÆöBannerÈÅÆÊå° */
        position: relative;
      }

      .brand-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 15px 15px 15px;
      }
      .brand-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #222;
        margin: 0;
        text-transform: uppercase;
      }
      .brand-see-all {
        font-size: 0.85rem;
        color: #666;
        text-decoration: underline;
        cursor: pointer;
        padding: 5px;
      }

      /* ÊªöÂä®ÂÆπÂô®ÂåÖË£ÖÂô® */
      .scroll-container-wrapper {
        position: relative;
        padding: 0 5px;
      }

      .scroll-wrapper {
        display: flex;
        overflow-x: auto;
        gap: 12px;
        padding: 5px 12px 15px 12px;
        scrollbar-width: none;
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: x mandatory;
        scroll-behavior: smooth;
      }
      .scroll-wrapper::-webkit-scrollbar {
        display: none;
      }

      /* Â∑¶Âè≥ÁÆ≠Â§¥ÊåâÈíÆ */
      .scroll-arrow-btn {
        position: absolute;
        top: 38%;
        transform: translateY(-50%);
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        z-index: 10;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s, transform 0.2s;
        font-size: 1.2rem;
        color: #333;
        border: 1px solid #eee;
      }
      .scroll-arrow-btn.visible {
        opacity: 1;
        pointer-events: auto;
      }
      .scroll-arrow-btn.active {
        transform: translateY(-50%) scale(0.9);
        background: #eee;
      }
      .scroll-arrow-btn.left {
        left: 5px;
      }
      .scroll-arrow-btn.right {
        right: 5px;
      }

      /* ÊªöÂä®ÊåáÁ§∫Âô® */
      .scroll-progress-container {
        width: 60px;
        height: 4px;
        background: #eee;
        border-radius: 2px;
        margin: 0 auto;
        margin-top: -5px;
        overflow: hidden;
      }
      .scroll-progress-bar {
        height: 100%;
        width: 0;
        background: var(--accent-color);
        border-radius: 2px;
        transition: width 0.1s linear;
      }

      .scroll-card {
        flex: 0 0 150px;
        display: flex;
        flex-direction: column;
        background: #fff;
        cursor: pointer;
        position: relative;
        scroll-snap-align: start;
      }

      .img-wrapper {
        width: 100%;
        height: 150px;
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 8px;
        position: relative;
      }
      .img-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .badges-container {
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        z-index: 2;
      }
      .badge-tag {
        font-size: 0.65rem;
        font-weight: bold;
        color: #fff;
        padding: 3px 6px;
        margin-bottom: 2px;
        border-radius: 0 0 4px 0;
        box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        text-transform: uppercase;
      }
      .badge-hot {
        background: var(--tag-hot);
      }
      .badge-new {
        background: var(--tag-new);
      }
      .badge-sale {
        background: var(--tag-sale);
      }

      .scroll-card-title {
        font-size: 0.85rem;
        color: #333;
        margin-bottom: 4px;
        height: 2.4em;
        overflow: hidden;
        text-transform: uppercase;
        line-height: 1.2;
        font-weight: 500;
      }
      .scroll-card-price {
        font-size: 1rem;
        color: var(--accent-color);
        font-weight: 700;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
      }
      .scroll-card-add {
        font-size: 0.85rem;
        color: #000;
        font-weight: 700;
        text-decoration: underline;
        margin-top: auto;
        padding: 5px 0;
      }

      .shop-all-section {
        padding: 30px 20px;
        text-align: center;
        background: #fff;
        margin-bottom: 20px;
        border-top: 1px solid #eee;
        border-bottom: 1px solid #eee;
      }
      .shop-all-btn {
        background: #000;
        color: #fff;
        padding: 15px 40px;
        font-size: 1.1rem;
        font-weight: bold;
        border-radius: 30px;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        transition: transform 0.2s;
      }

      /* ================= 7. ÁΩëÊ†ºËßÜÂõæ (Grid View) ================= */
      #grid-view {
        display: none;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px 12px;
      }
      .gallery-header-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .gallery-title {
        font-size: 1.3rem;
        font-weight: 700;
      }
      .back-home-btn {
        font-size: 0.9rem;
        text-decoration: underline;
        cursor: pointer;
        color: #666;
        padding: 5px;
      }

      .gallery {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      @media (min-width: 768px) {
        .gallery {
          grid-template-columns: repeat(4, 1fr);
          gap: 30px;
        }
      }

      .item {
        background: #fff;
        border-radius: 8px;
        border: 1px solid #eee;
        overflow: hidden;
      }
      .item-img-box {
        height: 180px;
        width: 100%;
        position: relative;
        overflow: hidden;
      }
      .item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        cursor: pointer;
      }
      .item .caption {
        padding: 10px 8px;
        text-align: center;
      }
      .item-price {
        font-weight: bold;
        color: var(--accent-color);
        font-size: 1rem;
      }
      .grid-add-btn {
        display: block;
        width: 100%;
        margin-top: 10px;
        background: #000;
        color: #fff;
        text-align: center;
        padding: 10px 0;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
      }

      /* ===== Updated Pagination CSS ===== */
      .pagination-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin: 30px 0;
        flex-wrap: wrap;
      }
      .page-btn {
        padding: 8px 14px; /* Ë∞ÉÊï¥Â§ßÂ∞è */
        background-color: #222;
        color: #fff;
        border-radius: 4px; /* ÊñπÂΩ¢ÂúÜËßí */
        cursor: pointer;
        font-size: 0.9rem;
        min-width: 36px;
        text-align: center;
        transition: all 0.2s;
        border: 1px solid transparent;
      }
      .page-btn:hover {
        background-color: #444;
      }
      .page-btn:disabled {
        background-color: #eee;
        color: #aaa;
        cursor: not-allowed;
      }
      .page-btn.active {
        background-color: var(--accent-color); /* ÈÄâ‰∏≠È´ò‰∫Æ */
        color: #000;
        font-weight: bold;
        border: 1px solid #997a00;
        transform: scale(1.05);
      }
      /* ================================== */

      /* ================= 8. Trust Section & Modal ================= */
      .trust-section {
        background: #fff;
        margin-top: 20px;
        padding: 30px 20px;
        border-top: 1px solid #eee;
      }
      .trust-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 20px;
        text-align: center;
      }
      @media (min-width: 768px) {
        .trust-grid {
          grid-template-columns: repeat(2, 1fr);
          max-width: 800px;
          margin: 0 auto;
        }
      }
      .trust-item {
        padding: 20px;
        border: 1px solid #eee;
        border-radius: 8px;
        display: block;
        background: #fff;
      }
      .trust-item h4 {
        margin: 10px 0 5px;
        font-size: 1.1rem;
      }
      .trust-item p {
        font-size: 0.9rem;
        color: #666;
        margin: 0;
        line-height: 1.4;
      }

      .modal {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.85);
        z-index: 2000;
        align-items: center;
        justify-content: center;
        padding: 15px;
      }
      .modal.open {
        display: flex;
      }
      .modal-content {
        background: #fff;
        width: 100%;
        max-width: 400px;
        border-radius: 12px;
        overflow: hidden;
        position: relative;
        text-align: center;
        padding-bottom: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }
      .modal-close {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 1.8rem;
        cursor: pointer;
        z-index: 10;
        width: 36px;
        height: 36px;
        background: rgba(0, 0, 0, 0.1);
        border-radius: 50%;
        line-height: 34px;
      }
      .modal-img {
        width: 100%;
        height: 300px;
        object-fit: cover;
        background: #f8f8f8;
      }
      .modal-info {
        padding: 8px 15px;
      }
      .modal-btn {
        background: #000;
        color: #fff;
        padding: 12px 0;
        width: 100%;
        font-size: 1rem;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        margin-top: 8px;
        display: block;
      }

      .qty-control-box {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #fff;
        border: 2px solid #000;
        border-radius: 8px;
        margin-top: 8px;
        height: 48px;
        overflow: hidden;
      }
      .qty-btn {
        width: 60px;
        height: 100%;
        font-size: 1.5rem;
        font-weight: bold;
        background: #000;
        color: #fff;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .qty-val {
        flex: 1;
        font-size: 1.2rem;
        font-weight: bold;
        color: #000;
      }

      #toast {
        visibility: hidden;
        min-width: 200px;
        background-color: rgba(0, 0, 0, 0.9);
        color: #fff;
        text-align: center;
        border-radius: 30px;
        padding: 12px 20px;
        position: fixed;
        z-index: 9999;
        left: 50%;
        bottom: 80px;
        transform: translateX(-50%);
        font-size: 0.95rem;
        font-weight: 500;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        opacity: 0;
        transition: all 0.3s;
      }
      #toast.show {
        visibility: visible;
        opacity: 1;
        bottom: 90px;
      }

      /* Loading Spinner */
      .loading-container {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 300px;
        width: 100%;
      }
      .spinner {
        width: 40px;
        height: 40px;
        border: 3px solid #eee;
        border-top: 3px solid var(--accent-color);
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        margin-bottom: 15px;
      }
      .loading-text {
        font-size: 0.9rem;
        color: #999;
        font-weight: 500;
        letter-spacing: 1px;
        animation: pulse 1.5s ease-in-out infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      @keyframes pulse {
        0% {
          opacity: 0.6;
        }
        50% {
          opacity: 1;
        }
        100% {
          opacity: 0.6;
        }
      }

      /* ================= 9. Gender Tags & Notes ================= */
      .modal-notes-box {
        background-color: #f7f7f7;
        border-radius: 8px;
        padding: 6px 10px;
        margin-bottom: 6px;
        text-align: left;
        border: 1px solid #eee;
      }
      .modal-notes-title {
        font-size: 0.7rem;
        font-weight: 700;
        color: #999;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 2px;
        display: block;
      }
      .modal-notes-text {
        font-size: 0.85rem;
        color: #444;
        line-height: 1.3;
        font-family: Georgia, serif;
        font-style: italic;
      }

      .gender-tag {
        display: inline-block;
        font-size: 0.7rem;
        padding: 1px 6px;
        border-radius: 4px;
        margin-left: 5px;
        vertical-align: middle;
        font-weight: 600;
        letter-spacing: 0.5px;
      }
      .gender-tag.women {
        color: #c2185b;
        background: #fce4ec;
        border: 1px solid #f8bbd0;
      }
      .gender-tag.men {
        color: #1565c0;
        background: #e3f2fd;
        border: 1px solid #bbdefb;
      }
      .gender-tag.unisex {
        color: #455a64;
        background: #eceff1;
        border: 1px solid #cfd8dc;
      }
    </style>
  </head>
  <body>
    <header class="site-header">
      <div class="header-left" id="menu-trigger">
        <span class="hamburger-icon">‚ò∞</span>
        <span class="menu-text" style="margin-left: 5px">MENU</span>
      </div>
      <div class="header-center">
        <input
          type="text"
          id="global-search-input"
          class="header-search-input"
          placeholder="Search..."
        />
      </div>
      <div class="header-right" onclick="window.location.href='cart.html'">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="white"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="20" cy="21" r="1"></circle>
          <path
            d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
          ></path>
        </svg>
        <span id="header-cart-count" class="header-cart-badge">0</span>
      </div>
    </header>

    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-tab active">MENU</div>
      </div>
      <div class="sidebar-content">
        <nav>
          <a class="menu-link" onclick="handleMenuClick('Home')">Home</a>
          <a class="menu-link" onclick="handleMenuClick('All')">Shop All</a>

          <a
            class="menu-link"
            onclick="handleMenuClick('Gender:Women')"
            style="color: #c2185b"
            >For Her üë©</a
          >
          <a
            class="menu-link"
            onclick="handleMenuClick('Gender:Men')"
            style="color: #1565c0"
            >For Him üë®</a
          >
          <a
            class="menu-link"
            onclick="handleMenuClick('Gender:Unisex')"
            style="color: #455a64"
            >Unisex ‚ö§</a
          >

          <a class="menu-link" onclick="handleMenuClick('BestSellers')"
            >Best Sellers üî•</a
          >
          <a class="menu-link" onclick="handleMenuClick('New')"
            >New Arrivals üÜï</a
          >
          <a class="menu-link" href="cart.html">My Cart</a>
          <a class="menu-link" href="https://wa.me/16232027321" target="_blank"
            >Contact Us</a
          >
        </nav>
        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee" />
        <div
          style="
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: #999;
            letter-spacing: 1px;
          "
        >
          POPULAR BRANDS
        </div>
        <div class="brand-list" id="brand-list-container"></div>
        <div style="height: 50px"></div>
      </div>
    </div>

    <div id="home-view">
      <div id="wholesale-banner" class="ws-banner">
        <div id="ws-content" class="ws-pills">
          <div class="ws-pill">5+ <span>-8%</span></div>
          <div class="ws-pill">10+ <span>-14%</span></div>
          <div class="ws-pill">20+ <span>-24%</span></div>
          <div class="ws-pill">100+ <span>-35%</span></div>
        </div>
      </div>
      <div class="compact-guide">
        <div class="compact-steps">
          <div class="compact-item">
            <span class="compact-icon">üõí</span>
            <div class="compact-text">1. Add to Cart</div>
            <span class="compact-sub">Auto Discount</span>
          </div>

          <div class="compact-item">
            <span class="compact-icon" style="color: #25d366">üí¨</span>
            <div class="compact-text">2. Send List</div>
            <span class="compact-sub">To WhatsApp</span>
          </div>

          <div class="compact-item">
            <span class="compact-icon" style="color: #b28900">üßæ</span>
            <div class="compact-text">3. Make Order</div>
            <span class="compact-sub">Payment Link</span>
          </div>
        </div>
      </div>
      <div id="home-content">
        <div class="loading-container">
          <div class="spinner"></div>
          <div class="loading-text">LOADING...</div>
        </div>
      </div>
    </div>

    <div id="grid-view">
      <div class="gallery-header-bar">
        <div class="gallery-title" id="grid-title">Results</div>
        <div class="back-home-btn" onclick="handleMenuClick('Home')">
          Back to Home
        </div>
      </div>
      <div class="gallery" id="gallery"></div>

      <div id="pagination-controls" class="pagination-container"></div>
    </div>

    <div class="trust-section">
      <div class="trust-grid">
        <div class="trust-item">
          <div style="font-size: 2rem; margin-bottom: 10px">üá∫üá∏</div>
          <h4>USA Warehouse</h4>
          <p>Fast delivery within 3-5 days.</p>
        </div>
        <div class="trust-item">
          <div style="font-size: 2rem; margin-bottom: 10px">üöö</div>
          <h4>Free Shipping</h4>
          <p>On all orders. No hidden fees.</p>
        </div>
        <div class="trust-item">
          <div style="font-size: 2rem; color: #3498db; margin-bottom: 10px">
            üõ°Ô∏è
          </div>
          <h4>Broken? We Reship!</h4>
          <p>Full replacement if damaged in transit.</p>
          <button
            onclick="document.getElementById('policy-modal').classList.add('open')"
            style="
              text-decoration: underline;
              cursor: pointer;
              color: blue;
              margin-top: 10px;
              font-size: 0.9rem;
            "
          >
            See Policy
          </button>
        </div>
        <a href="https://wa.me/16232027321" target="_blank" class="trust-item">
          <div style="font-size: 2rem; color: #2ecc71; margin-bottom: 10px">
            üí¨
          </div>
          <h4>WhatsApp Support</h4>
          <p>24/7 instant quote & service.</p>
          <span
            style="
              color: blue;
              text-decoration: underline;
              margin-top: 10px;
              display: block;
              font-size: 0.9rem;
            "
            >Chat Now</span
          >
        </a>
      </div>
    </div>

    <div id="toast">Added to Cart! üõí</div>

    <div id="modal" class="modal">
      <div class="modal-content">
        <div
          class="modal-close"
          onclick="document.getElementById('modal').classList.remove('open')"
        >
          &times;
        </div>
        <img id="modal-img" class="modal-img" src="" />
        <div class="modal-info">
          <h3
            id="modal-title"
            style="margin: 5px 0 2px 0; font-size: 1.1rem; line-height: 1.2"
          ></h3>

          <div
            id="modal-sub"
            style="color: #666; font-size: 0.85rem; margin-bottom: 8px"
          ></div>

          <div
            id="modal-price"
            style="
              font-weight: bold;
              color: var(--accent-color);
              font-size: 1.3rem;
              margin-bottom: 8px;
            "
          ></div>
          <div id="modal-action-area"></div>
        </div>
      </div>
    </div>

    <div class="modal" id="policy-modal">
      <div
        class="modal-content"
        style="padding: 25px; text-align: left; max-width: 90%"
      >
        <div
          class="modal-close"
          onclick="document.getElementById('policy-modal').classList.remove('open')"
        >
          &times;
        </div>
        <h3 style="text-align: center; margin-top: 0">Reshipment Policy</h3>
        <p>If items arrive broken or leaked:</p>
        <ul style="padding-left: 20px; color: #555">
          <li style="margin-bottom: 10px">
            Take a photo of the <strong>Shipping Label</strong>.
          </li>
          <li>Take a photo of the <strong>Damaged Item</strong>.</li>
        </ul>
        <p style="text-align: center; font-weight: bold; margin-top: 20px">
          Send to WhatsApp for free reshipment.
        </p>
      </div>
    </div>

    <script src="db.js"></script>
    <script>
      // ================= ÈÖçÁΩÆÂå∫ =================
      const FEATURED_BRANDS = [
        "Creed",
        "Dior",
        "Chanel",
        "Tom Ford",
        "Yves Saint Laurent",
        "Louis Vuitton",
        "Gucci",
        "Carolina Herrera",
        "Valentino",
        "Maison Francis Kurkdjian",
        "Parfums de Marly",
        "Jean Paul Gaultier",
        "Xerjoff",
        "Bond No. 9",
        "Initio",
        "Paco Rabanne",
        "Giorgio Armani",
        "Burberry",
        "Versace",
      ];

      // === ÂÖ®Â±ÄÊäòÊâ£ËßÑÂàô (Discount Tiers) ===
      const discountTiers = [
        { min: 1, max: 1, percent: 0 },
        { min: 2, max: 2, percent: 0.03 },
        { min: 3, max: 4, percent: 0.05 },
        { min: 5, max: 9, percent: 0.08 },
        { min: 10, max: 19, percent: 0.14 },
        { min: 20, max: 29, percent: 0.24 },
        { min: 30, max: 49, percent: 0.26 },
        { min: 50, max: 79, percent: 0.29 },
        { min: 80, max: 100, percent: 0.32 },
        { min: 101, max: Infinity, percent: 0.35 },
      ];

      // ================= Áä∂ÊÄÅÂèòÈáè =================
      let cartItems = [];
      let currentPage = 1;
      const itemsPerPage = 20;
      let currentGridData = [];
      let viewMode = "home";
      let currentModalProductId = null;

      document.addEventListener("DOMContentLoaded", () => {
        loadCart();
        setupMenu();
        renderSidebarBrands();
        // setupEventListeners(); // ÁßªÈô§ÔºöÂàÜÈ°µÁõëÂê¨Âô®Áé∞Âú®ÂÆåÂÖ®Âä®ÊÄÅÁîüÊàê
        setupModalBackdropClosing();
        setupSearch();

        const checkDataInterval = setInterval(() => {
          if (window.perfumeDB && window.perfumeDB.length > 0) {
            clearInterval(checkDataInterval);
            renderHome();
          }
        }, 50);
      });

      // ================= Ê†∏ÂøÉ‰øÆÂ§ç‰ª£Á†ÅÔºöÁõëÂê¨ pageshow =================
      // ËøôÂèØ‰ª•Á°Æ‰øùÂΩìÁî®Êà∑ÁÇπÂáª‚ÄúÂêéÈÄÄ‚ÄùÂõûÂà∞Ê≠§È°µÈù¢Êó∂ÔºåË¥≠Áâ©ËΩ¶ÂíåÊ®™ÂπÖÊï∞ÊçÆ‰ºöÁ´ãÂç≥Âà∑Êñ∞
      window.addEventListener("pageshow", function (event) {
        loadCart(); // ÈáçÊñ∞ËØªÂèñ localStorage Âπ∂Êõ¥Êñ∞ UIÔºàÂåÖÊã¨Ê®™ÂπÖÔºâ
      });

      // --- Helper: Ëé∑ÂèñË¥≠Áâ©ËΩ¶ÊÄªÊï∞Èáè ---
      function getCartTotalQty() {
        return cartItems.reduce((s, i) => s + i.quantity, 0);
      }

      // --- Helper: Ê†∏ÂøÉÔºÅÊõ¥Êñ∞È¶ñÈ°µÊâπÂèëÊ®™ÂπÖ ---
      function updateWholesaleBanner() {
        const qty = getCartTotalQty();
        const banner = document.getElementById("wholesale-banner");
        const content = document.getElementById("ws-content");

        if (!banner || !content) return;

        // 1. Â¶ÇÊûúË¥≠Áâ©ËΩ¶‰∏∫Á©∫ÔºåÊòæÁ§∫ÈªòËÆ§Âê∏Âºï‰∫∫ÁöÑÊ°£‰Ωç
        if (qty === 0) {
          banner.className = "ws-banner"; // ÁßªÈô§ active Á±ª
          content.innerHTML = `
              <div class="ws-pill">5+ <span>-8%</span></div>
              <div class="ws-pill">10+ <span>-14%</span></div>
              <div class="ws-pill">20+ <span>-24%</span></div>
              <div class="ws-pill">100+ <span>-35%</span></div>
            `;
          return;
        }

        // 2. Êü•ÊâæÂΩìÂâçÊâÄÂ§ÑÁöÑÊ°£‰Ωç
        let currentTier = discountTiers.find(
          (t) => qty >= t.min && qty <= t.max
        );
        if (!currentTier) currentTier = discountTiers[0]; // ÂÖúÂ∫ï

        // 3. Êü•Êâæ‰∏ã‰∏ÄÁ∫ßÁõÆÊ†á
        let nextTierIndex = discountTiers.indexOf(currentTier) + 1;
        let nextTier = null;
        if (nextTierIndex < discountTiers.length) {
          nextTier = discountTiers[nextTierIndex];
        }

        // 4. ÊûÑÂª∫Âä®ÊÄÅ HTML
        let html = `<div class="ws-progress-box">`;

        // ÊòæÁ§∫ÂΩìÂâçÁä∂ÊÄÅ
        let currentOff = Math.round(currentTier.percent * 100);
        html += `<div class="ws-progress-text">Cart: <strong>${qty}</strong> items ‚Ä¢ Current: <span class="ws-highlight">-${currentOff}% OFF</span></div>`;

        // ÊòæÁ§∫ÂÜ≤Âà∫ÁõÆÊ†á
        if (nextTier) {
          let needMore = nextTier.min - qty;
          let nextOff = Math.round(nextTier.percent * 100);
          html += `<div style="font-size:0.75rem; color:#ccc;">
                üî• Add <strong>${needMore}</strong> more to get <span style="color:#fff;font-weight:bold">-${nextOff}% OFF</span>!
            </div>`;
        } else {
          // Â∑≤ÁªèÊòØÊúÄÈ´òÁ≠âÁ∫ß
          html += `<div style="font-size:0.75rem; color:#ffd700;">üëë Maximum Discount Unlocked!</div>`;
        }

        html += `</div>`;

        // Êõ¥Êñ∞ÂÜÖÂÆπÂπ∂ÊøÄÊ¥ªÊ†∑Âºè
        content.innerHTML = html;
        banner.classList.add("active-tier");
      }

      function formatSize(item) {
        if (!item.ml) return "";
        const ml = parseInt(item.ml);
        if (isNaN(ml)) return item.ml;
        const flOz = (ml / 29.57).toFixed(1);
        return `${ml}ml <span style="color:#999;font-weight:normal">(${flOz} oz)</span>`;
      }

      // --- Helper: Ëé∑ÂèñÊÄßÂà´Ê†∑ÂºèÁ±ª ---
      function getGenderClass(genderText) {
        if (!genderText) return "unisex";
        const g = genderText.toLowerCase();
        if (g.includes("women") || g.includes("female")) return "women";
        if (g.includes("men") || g.includes("male")) return "men";
        return "unisex";
      }

      function renderSidebarBrands() {
        const list = document.getElementById("brand-list-container");
        list.innerHTML = "";
        FEATURED_BRANDS.forEach((brand) => {
          const div = document.createElement("div");
          div.className = "brand-item";
          div.textContent =
            brand === "Yves Saint Laurent" ? "YSL" : brand.toUpperCase();
          div.onclick = () => scrollToBrand(brand);
          list.appendChild(div);
        });
        const otherDiv = document.createElement("div");
        otherDiv.className = "brand-item";
        otherDiv.style.cssText =
          "font-weight: bold; margin-top: 10px; color: var(--accent-color); border-bottom: none;";
        otherDiv.textContent = "OTHER BRANDS";
        otherDiv.onclick = () => scrollToBrand("Other");
        list.appendChild(otherDiv);
      }

      // --- Helper: ÁîüÊàê WebP Picture Ê†áÁ≠æÂ≠óÁ¨¶‰∏≤ ---
      function generatePictureHTML(src, alt) {
        const webpSrc = src.replace(/\.(jpg|png|jpeg)$/i, ".webp");
        return `
          <div class="img-wrapper skeleton-loader">
             <picture>
                <source srcset="${webpSrc}" type="image/webp">
                <img 
                    src="${src}" 
                    alt="${alt}" 
                    loading="lazy" 
                    class="lazy-img"
                    onload="this.classList.add('loaded'); this.parentElement.parentElement.classList.remove('skeleton-loader');"
                    onerror="this.parentElement.parentElement.classList.remove('skeleton-loader');"
                >
             </picture>
          </div>
        `;
      }

      // --- 1. È¶ñÈ°µÊ∏≤ÊüìÈÄªËæë ---
      function renderHome() {
        const db = (window.perfumeDB || []).filter(
          (p) => parseInt(p.stock) !== 0
        );
        const container = document.getElementById("home-content");
        if (!container) return;

        container.innerHTML = "";

        // Helper to render sections
        const renderSection = (title, items, filterKey) => {
          const section = createBrandSection(title, items, filterKey);
          if (
            filterKey &&
            filterKey !== "BestSellers" &&
            filterKey !== "New" &&
            filterKey !== "Sale"
          ) {
            section.id = "brand-" + filterKey.replace(/\s+/g, "");
          }
          container.appendChild(section);
        };

        const bestSellers = db.filter((p) => p.top == 1);
        if (bestSellers.length > 0)
          renderSection("üî• Best Sellers", bestSellers, "BestSellers");

        const newArrivals = db.filter((p) => p.new == 1);
        if (newArrivals.length > 0)
          renderSection("üÜï New Arrivals", newArrivals, "New");

        const renderedBrands = new Set();
        FEATURED_BRANDS.forEach((brand) => {
          const products = db.filter((p) =>
            p.brand.toLowerCase().includes(brand.toLowerCase())
          );
          if (products.length >= 3) {
            let displayName =
              brand === "Yves Saint Laurent" ? "YSL" : brand.toUpperCase();
            renderSection(displayName, products, brand);
            renderedBrands.add(brand);
          }
        });

        const otherProducts = db.filter((p) => {
          for (let featured of renderedBrands) {
            if (p.brand.toLowerCase().includes(featured.toLowerCase()))
              return false;
          }
          return true;
        });

        if (otherProducts.length > 0) {
          const otherSection = createBrandSection(
            "Other Brands",
            otherProducts,
            "Other"
          );
          otherSection.id = "brand-Other";
          container.appendChild(otherSection);
        }

        const saleItems = db.filter((p) => p.sale == 1);
        if (saleItems.length > 0)
          renderSection("üè∑Ô∏è On Sale", saleItems, "Sale");

        const shopAllContainer = document.createElement("div");
        shopAllContainer.className = "shop-all-section";
        shopAllContainer.innerHTML = `<button class="shop-all-btn" onclick="handleMenuClick('All')">Shop All Products</button>`;
        container.appendChild(shopAllContainer);
      }

      function createBrandSection(title, products, filterKey) {
        const section = document.createElement("div");
        section.className = "brand-section";

        // Header
        const header = document.createElement("div");
        header.className = "brand-header";
        const cleanFilterKey =
          filterKey || (title.includes("Best") ? "BestSellers" : "All");
        header.innerHTML = `
            <h2 class="brand-title">${title}</h2>
            <div class="brand-see-all" onclick="switchToGrid('${cleanFilterKey}')">See All ></div>
        `;
        section.appendChild(header);

        // Scroll Container Wrapper
        const wrapperContainer = document.createElement("div");
        wrapperContainer.className = "scroll-container-wrapper";

        // Arrows
        const leftBtn = document.createElement("div");
        leftBtn.className = "scroll-arrow-btn left";
        leftBtn.innerHTML = "&#10094;";

        const rightBtn = document.createElement("div");
        rightBtn.className = "scroll-arrow-btn right";
        rightBtn.innerHTML = "&#10095;";

        // Scroll Wrapper
        const wrapper = document.createElement("div");
        wrapper.className = "scroll-wrapper";

        // Generate Cards
        products.slice(0, 15).forEach((p) => {
          const card = document.createElement("div");
          card.className = "scroll-card";
          card.onclick = (e) => {
            if (e.target.classList.contains("scroll-card-add")) return;
            openModal(p);
          };

          let badgesHtml = "";
          if (p.top == 1)
            badgesHtml += '<div class="badge-tag badge-hot">HOT</div>';
          if (p.new == 1)
            badgesHtml += '<div class="badge-tag badge-new">NEW</div>';
          if (p.sale == 1)
            badgesHtml += '<div class="badge-tag badge-sale">SALE</div>';

          const imgHtml = generatePictureHTML(p.img, p.name);

          // [‰øÆÊîπÁÇπ] Gender Â∏¶È¢úËâ≤Á±ª
          const genderClass = getGenderClass(p.gender);
          const genderHtml = p.gender
            ? `<span class="gender-tag ${genderClass}">${p.gender}</span>`
            : "";

          card.innerHTML = `
            <div style="position:relative;">
               ${imgHtml}
               <div class="badges-container">${badgesHtml}</div>
            </div>
            <div class="scroll-card-title">${p.id}-${p.name}</div>
            <div style="display:flex; align-items:center; margin-bottom:4px; flex-wrap:wrap;">
                <span style="font-size:0.75rem; color:#666; font-weight:600;">${
                  p.brand
                }</span>
                ${genderHtml}
            </div>
            <div class="scroll-card-price">
                $${p.price} 
                <span style="font-size:0.75rem; color:#666; font-weight:normal; margin-left:5px;">
                    ${p.ml ? p.ml + "ml" : ""}
                </span>
            </div>
            <div class="scroll-card-add" onclick="addToCart('${
              p.id
            }'); event.stopPropagation();">Add To Cart</div>
          `;
          wrapper.appendChild(card);
        });

        // Progress Bar
        const progressContainer = document.createElement("div");
        progressContainer.className = "scroll-progress-container";
        const progressBar = document.createElement("div");
        progressBar.className = "scroll-progress-bar";
        progressContainer.appendChild(progressBar);

        // Append everything
        wrapperContainer.appendChild(leftBtn);
        wrapperContainer.appendChild(wrapper);
        wrapperContainer.appendChild(rightBtn);
        section.appendChild(wrapperContainer);
        section.appendChild(progressContainer);

        // Logic: Arrows & Progress
        const updateControls = () => {
          const maxScroll = wrapper.scrollWidth - wrapper.clientWidth;
          const scrollLeft = wrapper.scrollLeft;

          if (scrollLeft > 10) leftBtn.classList.add("visible");
          else leftBtn.classList.remove("visible");

          if (scrollLeft < maxScroll - 10) rightBtn.classList.add("visible");
          else rightBtn.classList.remove("visible");

          if (maxScroll > 0) {
            const percentage = (scrollLeft / maxScroll) * 100;
            progressBar.style.width = Math.max(10, percentage) + "%";
          } else {
            progressBar.style.width = "100%";
          }
        };

        leftBtn.onclick = () =>
          wrapper.scrollBy({ left: -200, behavior: "smooth" });
        rightBtn.onclick = () =>
          wrapper.scrollBy({ left: 200, behavior: "smooth" });

        wrapper.addEventListener("scroll", updateControls);
        setTimeout(updateControls, 100);

        return section;
      }

      // --- 2. Grid Ê∏≤Êüì (Â∑≤Êõ¥Êñ∞ÊÄßÂà´Á≠õÈÄâ) ---
      function switchToGrid(criteria) {
        viewMode = "grid";
        document.getElementById("home-view").style.display = "none";
        document.getElementById("grid-view").style.display = "block";
        window.scrollTo({ top: 0, behavior: "smooth" });

        const db = (window.perfumeDB || []).filter(
          (p) => parseInt(p.stock) !== 0
        );
        let filtered = [];
        let title = "";

        if (criteria === "All") {
          filtered = db;
          title = "All Products";
        } else if (criteria === "BestSellers") {
          filtered = db.filter((p) => p.top == 1);
          title = "Best Sellers";
        } else if (criteria === "New") {
          filtered = db.filter((p) => p.new == 1);
          title = "New Arrivals";
        } else if (criteria === "Sale") {
          filtered = db.filter((p) => p.sale == 1);
          title = "On Sale";

          // ================= Êñ∞Â¢ûÈÄªËæëÂºÄÂßã =================
        } else if (criteria.startsWith("Gender:")) {
          const targetGender = criteria.split(":")[1]; // Ëé∑Âèñ 'Women', 'Men', 'Unisex'

          filtered = db.filter((p) => {
            if (!p.gender) return false;
            // ‰ΩøÁî®ÊÇ®Áé∞ÊúâÁöÑ getGenderClass ÈÄªËæëÊù•Âà§Êñ≠ÂΩíÂ±û
            // ËøôÊ†∑ÂèØ‰ª•Á°Æ‰øù "Women" ‰∏ç‰ºöÂõ†‰∏∫ÂåÖÂê´ "men" Â≠óÁ¨¶‰∏≤ËÄåË¢´ÂΩíÁ±ªÂà∞Áî∑Â£´
            const gClass = getGenderClass(p.gender);
            return gClass === targetGender.toLowerCase();
          });

          // ËÆæÁΩÆÊ†áÈ¢ò
          if (targetGender === "Women") title = "For Her (Women)";
          else if (targetGender === "Men") title = "For Him (Men)";
          else title = "Unisex Collection";
          // ================= Êñ∞Â¢ûÈÄªËæëÁªìÊùü =================
        } else if (criteria.startsWith("Search:")) {
          const term = criteria.replace("Search:", "").toLowerCase();
          filtered = db.filter(
            (p) =>
              p.name.toLowerCase().includes(term) ||
              p.brand.toLowerCase().includes(term) ||
              (p.id && p.id.toString().includes(term))
          );
          title = `Results: "${term}"`;
        } else if (criteria === "Other") {
          filtered = db;
          title = "More Brands";
        } else {
          filtered = db.filter((p) => p.brand.includes(criteria));
          title = criteria;
        }

        document.getElementById("grid-title").textContent = title;
        currentGridData = filtered;
        currentPage = 1;
        renderGridPage();
      }

      function renderGridPage() {
        const gallery = document.getElementById("gallery");
        gallery.innerHTML = "";

        // ÂàÜÈ°µÈÄªËæëÊõ¥Êñ∞ÔºöÁõ¥Êé•Ë∞ÉÁî® renderPagination
        const totalPages = Math.ceil(currentGridData.length / itemsPerPage);
        renderPagination(totalPages, currentPage);

        if (currentGridData.length === 0) {
          gallery.innerHTML =
            "<div style='grid-column:1/-1;text-align:center;padding:50px;color:#999;'>No items found.</div>";
          return;
        }

        const start = (currentPage - 1) * itemsPerPage;
        const pageItems = currentGridData.slice(start, start + itemsPerPage);

        pageItems.forEach((p) => {
          const div = document.createElement("div");
          div.className = "item";

          let badgesHtml = "";
          if (p.top == 1)
            badgesHtml += '<div class="badge-tag badge-hot">HOT</div>';
          if (p.new == 1)
            badgesHtml += '<div class="badge-tag badge-new">NEW</div>';
          if (p.sale == 1)
            badgesHtml += '<div class="badge-tag badge-sale">SALE</div>';

          const webpSrc = p.img.replace(/\.(jpg|png|jpeg)$/i, ".webp");

          // [‰øÆÊîπÁÇπ] Grid ÈáåÁöÑ Gender È¢úËâ≤
          const genderClass = getGenderClass(p.gender);
          const genderText = p.gender
            ? ` ¬∑ <span class="gender-tag ${genderClass}" style="margin-left:0">${p.gender}</span>`
            : "";

          div.innerHTML = `
              <div class="item-img-box skeleton-loader" onclick="openModalById('${
                p.id
              }')">
                  <picture>
                     <source srcset="${webpSrc}" type="image/webp">
                     <img 
                        src="${p.img}" 
                        loading="lazy" 
                        class="lazy-img"
                        onload="this.classList.add('loaded'); this.parentElement.parentElement.classList.remove('skeleton-loader');"
                        onerror="this.parentElement.parentElement.classList.remove('skeleton-loader');"
                    >
                  </picture>
                  <div class="badges-container">${badgesHtml}</div>
              </div>
              <div class="caption">
                 <div style="font-size:0.85rem; height:2.4em; overflow:hidden; margin-bottom:5px; line-height:1.2;">
                    ${p.id}-${p.name}
                 </div>
                 <div style="font-size:0.8rem; color:#888; margin-bottom:5px;">
                    ${p.brand}${genderText} <br>
                    ${formatSize(p)}
                 </div>
                 <div class="item-price">$${p.price}</div>
                 <button class="grid-add-btn" onclick="addToCart('${
                   p.id
                 }')">ADD TO CART</button>
              </div>
           `;
          gallery.appendChild(div);
        });
      }

      /* ================= New Pagination Logic ================= */
      function renderPagination(totalPages, currentPage) {
        const container = document.getElementById("pagination-controls");
        if (!container) return;
        container.innerHTML = ""; // Clear existing

        if (totalPages <= 1) {
          container.style.display = "none";
          return;
        }
        container.style.display = "flex";

        // Helper to create button
        const createBtn = (
          text,
          page,
          isActive = false,
          isDisabled = false
        ) => {
          const btn = document.createElement("button");
          btn.className = `page-btn ${isActive ? "active" : ""}`;
          btn.textContent = text;
          if (isDisabled) {
            btn.disabled = true;
          } else {
            btn.onclick = () => {
              window.currentPage = page;
              renderGridPage();
              window.scrollTo({ top: 0, behavior: "smooth" });
            };
          }
          return btn;
        };

        // 1. Prev Button
        container.appendChild(
          createBtn("Prev", currentPage - 1, false, currentPage === 1)
        );

        // 2. Numeric Buttons (Smart Logic)
        const pages = [];
        if (totalPages <= 7) {
          // Â¶ÇÊûúÂ∞ë‰∫é7È°µÔºåÁõ¥Êé•ÂÖ®ÊòæÁ§∫ [1] [2] [3]...
          for (let i = 1; i <= totalPages; i++) pages.push(i);
        } else {
          // Â¶ÇÊûúÈ°µÊï∞ÂæàÂ§öÔºåÊòæÁ§∫Â§¥Â∞æÂíåÂΩìÂâçÈ°µÂë®Âõ¥
          // Always show 1
          pages.push(1);

          // Â¶ÇÊûúÂΩìÂâçÈ°µÁ¶ª1ÊØîËæÉËøúÔºåÂä†ÁúÅÁï•Âè∑
          if (currentPage > 3) pages.push("...");

          // ËÆ°ÁÆó‰∏≠Èó¥ÊòæÁ§∫ÁöÑËåÉÂõ¥
          let s = Math.max(2, currentPage - 1);
          let e = Math.min(totalPages - 1, currentPage + 1);

          // ËæπÁïå‰øÆÊ≠£
          if (currentPage === 1) e = 3;
          if (currentPage === totalPages) s = totalPages - 2;

          for (let i = s; i <= e; i++) pages.push(i);

          // Â¶ÇÊûúÂΩìÂâçÈ°µÁ¶ªÊúÄÂêé‰∏ÄÈ°µËøúÔºåÂä†ÁúÅÁï•Âè∑
          if (currentPage < totalPages - 2) pages.push("...");

          // Always show last page
          pages.push(totalPages);
        }

        pages.forEach((p) => {
          if (p === "...") {
            const span = document.createElement("span");
            span.textContent = "...";
            span.style.padding = "0 5px";
            span.style.color = "#999";
            container.appendChild(span);
          } else {
            container.appendChild(createBtn(p, p, p === currentPage));
          }
        });

        // 3. Next Button
        container.appendChild(
          createBtn("Next", currentPage + 1, false, currentPage === totalPages)
        );
      }
      /* ========================================================= */

      // --- 3. ÂºπÁ™óÈÄªËæë ---
      window.openModal = function (product) {
        currentModalProductId = product.id;
        document.getElementById("modal-img").src = product.img;

        document.getElementById(
          "modal-title"
        ).textContent = `${product.id}-${product.name}`;

        // Notes ÊòæÁ§∫ÈÄªËæë
        const notesContent = product.Notes || product.notes;

        let notesHtml = "";
        if (notesContent && notesContent.trim() !== "") {
          notesHtml = `
            <div class="modal-notes-box">
              <span class="modal-notes-title">Fragrance Notes</span>
              <span class="modal-notes-text">${notesContent}</span>
            </div>
          `;
        }

        // [‰øÆÊîπÁÇπ] ÂºπÁ™ó Gender Â∏¶È¢úËâ≤
        const genderClass = getGenderClass(product.gender);

        document.getElementById("modal-sub").innerHTML = `
            <div style="font-size:1.1rem; color:#333; margin-bottom:5px;">${
              product.brand
            }</div>
            <div style="margin-bottom:8px; font-size:0.85rem; color:#555; display:flex; align-items:center; justify-content:center;">
              <span class="gender-tag ${genderClass}" style="font-size:0.8rem; margin:0 5px 0 0;">${
          product.gender || "Unisex"
        }</span>
              <span style="color:#ccc">|</span> 
              <span style="margin-left:5px">${formatSize(product)}</span>
            </div>
            ${notesHtml}
        `;

        // ÊÅ¢Â§çÁÆÄÂçïÁöÑ‰ª∑Ê†ºÊòæÁ§∫ÔºåÁßªÈô§‰πãÂâçÁöÑË°®Ê†ºÈÄªËæë
        document.getElementById("modal-price").textContent =
          "$" + product.price;

        updateModalButtonState(product.id);
        document.getElementById("modal").classList.add("open");
      };

      window.openModalById = function (id) {
        const p = window.perfumeDB.find((x) => x.id === id);
        if (p) openModal(p);
      };

      // --- 4. ÊêúÁ¥¢‰∏éÈÄöÁî®ÂäüËÉΩ ---
      function setupSearch() {
        const globalSearch = document.getElementById("global-search-input");
        globalSearch.addEventListener("change", (e) => {
          const val = e.target.value.trim();
          if (val) switchToGrid("Search:" + val);
        });
      }

      window.handleMenuClick = function (action) {
        document.getElementById("sidebar").classList.remove("active");
        document.getElementById("sidebar-overlay").classList.remove("active");
        if (action === "Home") {
          viewMode = "home";
          document.getElementById("home-view").style.display = "block";
          document.getElementById("grid-view").style.display = "none";
          window.scrollTo({ top: 0 });
        } else {
          switchToGrid(action);
        }
      };

      window.scrollToBrand = function (brandName) {
        if (viewMode !== "home") {
          document.getElementById("home-view").style.display = "block";
          document.getElementById("grid-view").style.display = "none";
          viewMode = "home";
        }
        document.getElementById("sidebar").classList.remove("active");
        document.getElementById("sidebar-overlay").classList.remove("active");

        setTimeout(() => {
          const safeName =
            brandName === "Other" ? "Other" : brandName.replace(/\s+/g, "");
          const targetId = "brand-" + safeName;
          const element = document.getElementById(targetId);
          if (element) {
            const headerOffset = 65;
            const elementPosition = element.getBoundingClientRect().top;
            const offsetPosition =
              elementPosition + window.pageYOffset - headerOffset;
            window.scrollTo({ top: offsetPosition, behavior: "smooth" });
          } else {
            switchToGrid(brandName === "Other" ? "Other" : brandName);
          }
        }, 50);
      };

      function setupMenu() {
        const trigger = document.getElementById("menu-trigger");
        const overlay = document.getElementById("sidebar-overlay");
        const sidebar = document.getElementById("sidebar");
        function toggle() {
          sidebar.classList.toggle("active");
          overlay.classList.toggle("active");
        }
        trigger.onclick = toggle;
        overlay.onclick = toggle;
      }

      window.addToCart = function (id) {
        const db = window.perfumeDB;
        const product = db.find((p) => p.id === id);
        if (!product) return;
        const existing = cartItems.find((c) => c.name === id);
        if (existing) {
          existing.quantity++;
        } else {
          cartItems.push({
            name: id,
            caption: `${id} - ${product.name} (${product.ml}ml)`,
            img: product.img,
            price: Number(product.price),
            brand: product.brand,
            ml: product.ml,
            quantity: 1,
          });
        }
        saveCart();
        showToast("Added to Cart! üõí");

        // ÂÖ≥ÈîÆÔºöÂä†Ë¥≠ÂêéÁ´ãÂç≥Êõ¥Êñ∞ÊäòÊâ£Ê®™ÂπÖ
        updateWholesaleBanner();

        if (currentModalProductId === id) updateModalButtonState(id);
      };

      function updateModalButtonState(id) {
        const container = document.getElementById("modal-action-area");
        const existing = cartItems.find((c) => c.name === id);
        if (!existing || existing.quantity === 0) {
          container.innerHTML = `<button class="modal-btn" onclick="modalFirstAdd('${id}')">ADD TO CART</button>`;
        } else {
          container.innerHTML = `
                <div class="qty-control-box">
                    <div class="qty-btn" onclick="modalChangeQty('${id}', -1)">-</div>
                    <div class="qty-val">${existing.quantity}</div>
                    <div class="qty-btn" onclick="modalChangeQty('${id}', 1)">+</div>
                </div>`;
        }
      }

      window.modalFirstAdd = (id) => addToCart(id);
      window.modalChangeQty = (id, delta) => {
        const existing = cartItems.find((c) => c.name === id);
        if (existing) {
          existing.quantity += delta;
          if (existing.quantity <= 0)
            cartItems = cartItems.filter((c) => c.name !== id);
          saveCart();

          // ÂÖ≥ÈîÆÔºö‰øÆÊîπÊï∞ÈáèÂêéÁ´ãÂç≥Êõ¥Êñ∞ÊäòÊâ£Ê®™ÂπÖ
          updateWholesaleBanner();

          updateModalButtonState(id);
        }
      };

      function showToast(msg) {
        const t = document.getElementById("toast");
        t.textContent = msg;
        t.classList.add("show");
        setTimeout(() => t.classList.remove("show"), 2000);
      }
      function loadCart() {
        cartItems = JSON.parse(localStorage.getItem("perfumeCart") || "[]");
        updateCartCount();

        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñÊ®™ÂπÖÁä∂ÊÄÅ
        updateWholesaleBanner();
      }
      function saveCart() {
        localStorage.setItem("perfumeCart", JSON.stringify(cartItems));
        updateCartCount();
      }
      function updateCartCount() {
        const el = document.getElementById("header-cart-count");
        if (el) el.textContent = cartItems.reduce((s, i) => s + i.quantity, 0);
      }

      function setupModalBackdropClosing() {
        document.querySelectorAll(".modal").forEach((o) =>
          o.addEventListener("click", (e) => {
            if (e.target === o) {
              o.classList.remove("open");
              currentModalProductId = null;
            }
          })
        );
      }
    </script>
  </body>
</html>
